# 키친포스

## 요구 사항

### 상품

- 상품을 등록할 수 있다.
- 상품의 가격이 올바르지 않으면 등록할 수 없다.
    - 상품의 가격은 0원 이상이어야 한다.
- 상품의 이름이 올바르지 않으면 등록할 수 없다.
    - 상품의 이름에는 비속어가 포함될 수 없다.
- 상품의 가격을 변경할 수 있다.
- 상품의 가격이 올바르지 않으면 변경할 수 없다.
    - 상품의 가격은 0원 이상이어야 한다.
- 상품의 가격이 변경될 때 메뉴의 가격이 메뉴에 속한 상품 금액의 합보다 크면 메뉴가 숨겨진다.
- 상품의 목록을 조회할 수 있다.

### 메뉴 그룹

- 메뉴 그룹을 등록할 수 있다.
- 메뉴 그룹의 이름이 올바르지 않으면 등록할 수 없다.
    - 메뉴 그룹의 이름은 비워 둘 수 없다.
- 메뉴 그룹의 목록을 조회할 수 있다.

### 메뉴

- 1 개 이상의 등록된 상품으로 메뉴를 등록할 수 있다.
- 상품이 없으면 등록할 수 없다.
- 메뉴에 속한 상품의 수량은 0 이상이어야 한다.
- 메뉴의 가격이 올바르지 않으면 등록할 수 없다.
    - 메뉴의 가격은 0원 이상이어야 한다.
- 메뉴에 속한 상품 금액의 합은 메뉴의 가격보다 크거나 같아야 한다.
- 메뉴는 특정 메뉴 그룹에 속해야 한다.
- 메뉴의 이름이 올바르지 않으면 등록할 수 없다.
    - 메뉴의 이름에는 비속어가 포함될 수 없다.
- 메뉴의 가격을 변경할 수 있다.
- 메뉴의 가격이 올바르지 않으면 변경할 수 없다.
    - 메뉴의 가격은 0원 이상이어야 한다.
- 메뉴에 속한 상품 금액의 합은 메뉴의 가격보다 크거나 같아야 한다.
- 메뉴를 노출할 수 있다.
- 메뉴의 가격이 메뉴에 속한 상품 금액의 합보다 높을 경우 메뉴를 노출할 수 없다.
- 메뉴를 숨길 수 있다.
- 메뉴의 목록을 조회할 수 있다.

### 주문 테이블

- 주문 테이블을 등록할 수 있다.
- 주문 테이블의 이름이 올바르지 않으면 등록할 수 없다.
    - 주문 테이블의 이름은 비워 둘 수 없다.
- 빈 테이블을 해지할 수 있다.
- 빈 테이블로 설정할 수 있다.
- 완료되지 않은 주문이 있는 주문 테이블은 빈 테이블로 설정할 수 없다.
- 방문한 손님 수를 변경할 수 있다.
- 방문한 손님 수가 올바르지 않으면 변경할 수 없다.
    - 방문한 손님 수는 0 이상이어야 한다.
- 빈 테이블은 방문한 손님 수를 변경할 수 없다.
- 주문 테이블의 목록을 조회할 수 있다.

### 주문

- 1개 이상의 등록된 메뉴로 배달 주문을 등록할 수 있다.
- 1개 이상의 등록된 메뉴로 포장 주문을 등록할 수 있다.
- 1개 이상의 등록된 메뉴로 매장 주문을 등록할 수 있다.
- 주문 유형이 올바르지 않으면 등록할 수 없다.
- 메뉴가 없으면 등록할 수 없다.
- 매장 주문은 주문 항목의 수량이 0 미만일 수 있다.
- 매장 주문을 제외한 주문의 경우 주문 항목의 수량은 0 이상이어야 한다.
- 배달 주소가 올바르지 않으면 배달 주문을 등록할 수 없다.
    - 배달 주소는 비워 둘 수 없다.
- 빈 테이블에는 매장 주문을 등록할 수 없다.
- 숨겨진 메뉴는 주문할 수 없다.
- 주문한 메뉴의 가격은 실제 메뉴 가격과 일치해야 한다.
- 주문을 접수한다.
- 접수 대기 중인 주문만 접수할 수 있다.
- 배달 주문을 접수되면 배달 대행사를 호출한다.
- 주문을 서빙한다.
- 접수된 주문만 서빙할 수 있다.
- 주문을 배달한다.
- 배달 주문만 배달할 수 있다.
- 서빙된 주문만 배달할 수 있다.
- 주문을 배달 완료한다.
- 배달 중인 주문만 배달 완료할 수 있다.
- 주문을 완료한다.
- 배달 주문의 경우 배달 완료된 주문만 완료할 수 있다.
- 포장 및 매장 주문의 경우 서빙된 주문만 완료할 수 있다.
- 주문 테이블의 모든 매장 주문이 완료되면 빈 테이블로 설정한다.
- 완료되지 않은 매장 주문이 있는 주문 테이블은 빈 테이블로 설정하지 않는다.
- 주문 목록을 조회할 수 있다.

## 용어 사전

### 메뉴와 상품

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 메뉴 | Menu | 주문 가능한 메뉴 |
| 메뉴 그룹 | Menu Group | 메뉴들의 분류 |
| 상품 | Product | 메뉴로 제공할 수 있는 상품. 한 상품이 여러개의 메뉴에 속할 수도 있음 |
| 메뉴에 속한 상품 | Menu Product | 메뉴에 실제로 속한 상품. 상품의 수량은 메뉴에 명시되어야 한다.  |
| 가격 | Price | 상품 혹은 메뉴의 가격. 메뉴의 가격은 수량에 따른 상품 가격의 총합 보다 작아야 한다. |
| 이름 | Name | 손님들에게 보여지는 명칭 |
| 비속어 | Profanity | 이름을 지을때 필터링해야하는 단어 |
| 비속어 필터 웹 서비스 | PurgoMalum Client | 비속어를 필터링해주는 외부 클라이언트 |
| 메뉴 노출 | Display | 메뉴가 손님에게 노출되고, 주문이 가능한 상태 |
| 메뉴 숨김 | Hide | 메뉴가 손님에게 숨겨지고, 주문이 불가능한 상태 |
| 수량 | Quantity | 메뉴 혹은 상품의 갯수 |

### 주문 테이블

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 주문 테이블 | Order Table | 주문이 이루어지는 테이블 |
| 테이블 그룹 | Table Group | 테이블들의 그룹 |
| 손님 수 | Number Of Guests | 한 테이블에 앉아있는 손님의 숫자 |
| 빈 테이블 | Empty Table | 손님이 없는 테이블 |
| 빈 테이블 설정 | Clear | 테이블을 비우는 행위 |
| 빈 테이블 해지 | Sit | 테이블에 손님이 앉는 행위 |

### 주문

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 주문 | Order | 손님이 메뉴를 주문한 내용 |
| 서빙 | Serve | 주문의 내용을 실제로 제공하는 행위 |
| 배달 주소 | Delivery Address | 주문 배달시켜야하는 장소 |
| 배달 대행사 | Kitchen Riders Client | 배달을 대행해주는 라이더 |

#### 주문 유형

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 주문 유형 | Order Type | 가능한 주문 유형으로 배달, 포장, 매장이 존재 |
| 배달 주문 | Delivery | 배달 주소지로 배달되어야 하는 주문 유형 |
| 포장 주문 | Takeout | 손님이 매장에 와서 찾아가는 주문 유형 |
| 매장 주문 | Eat-In | 손님이 매장에서 식사하는 주문 유형 |

#### 주문 상태

| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 주문 상태 | Order Status | 주문의 현재 상태 |
| 접수 대기 | Waiting | 주문을 접수되기까지 기다리는 상태 |
| 접수 | Accepted | 주문이 처음 접수된 상태 |
| 제공 됨 | Served | 메뉴가 손님에게 제공된 상태 |
| 배달 중 | Delivering | 배달로 이동되는 상태 |
| 배달 완료 | Delivered | 배달이 완료된 상태 |
| 완료 | Completed | 주문의 처리가 완료된 상태 |

## 모델링

### 상품(Product) Context

#### 속성

- 상품은 손님에게 노출되는 이름(`name`) 을 가진다.
- 상품은 가치를 나타내는 `price` 를 가진다.

#### 기능/조건

- 상품을 등록할 수 있다.
    - `product` 의 `price` 는 0원 이상이어야 한다.
    - `product` 의 `name` 은 비워 둘 수 없다.
    - `product` 의 `name` 은 비속어(`profanity`)가 포함될 수 없다.
        - `PurgoMalum Client` 가 비속어를 필터링 한다.
- 상품의 가격을 변경할 수 있다.
    - 변경되는 `product` 의 `price` 는 0원 이상이어야 한다.
    - 변경 후 메뉴에 속한 상품(`menu product`) 금액의 합보다 메뉴(`menu`)의 가격이 크면 메뉴가 숨겨진다(`hide`).
- 상품의 목록을 조회할 수 있다.

### 메뉴 그룹(Menu Group) Context

#### 속성

- 메뉴 그룹은 손님에 노출되는 이름(`name`) 을 가진다.

#### 기능/조건

- 메뉴 그룹을 등록할 수 있다.
    - `menu group`의 `name` 은 비워 둘 수 없다.
    - `menu group`의 `name` 은 비속어(`profanity`)가 포함될 수 없다.
        - `PurgoMalum Client` 가 비속어를 필터링 한다.
- 메뉴 그룹의 목록을 조회할 수 있다.

### 메뉴(Menu) Context

#### 속성

- 메뉴는 손님에게 노출되는 `name` 을 가진다.
- 메뉴는 구매를 위해 지불해야하는 `price` 을 가진다.
- 메뉴는 자신이 속한 `menu group` 을 가진다.
- 메뉴는 자신이 속한 메뉴 그룹을 식별하기 위한 `menu group id` 을 가진다.
- 메뉴는 자신의 노출 여부를 나타내는 `displayed` 을 가진다.
- 메뉴는 자신에게 속한 상품들`menu products` 을 가진다.
    - `menu product` 는 `product` 를 가진다.
    - `menu product` 는 상품을 식별하기 위한 `product id` 를 가진다.
    - `menu product` 는 상품의 갯수(`quantity`)를 가진다.

#### 기능/조건

- 메뉴를 등록할 수 있다.
    - 메뉴를 등록하려면 등록된 `product` 가 1개 이상이어야 한다.
    - `menu product` 의 `quantity` 는 0 이상이어야 한다.
    - 메뉴의 `price` 는 0원 이상이어야 한다.
    - `menu product` 금액의 총합은 메뉴의 `price` 보다 크거나 같아야 한다.
    - 메뉴는 특정 `menu group` 에 속해야 한다.
    - 메뉴의 `name` 은 비워둘 수 없다.
    - 메뉴의 `name` 에는 `profanity` 가 포함될 수 없다.
        - `PurgoMalum Client` 가 비속어를 필터링 한다.
- 메뉴의 가격을 변경할 수 있다.
    - 변경 후 메뉴의 `price` 는 0원 이상이어야 한다.
    - 변경 후 `menu product` 금액의 총합은 메뉴의 `price` 보다 크거나 같아야 한다.
- 메뉴를 노출할 수 있다.
    - 메뉴의 `price` 가 `menu product` 금액의 총합 보다 높을 경우 노출할 수 없다.
- 메뉴를 숨길 수 있다.
- 메뉴의 목록을 조회할 수 있다.

### 주문 테이블(Order Table) Context

#### 속성

- 주문 테이블은 손님에게 노출되는 `name` 을 가진다.
- 주문 테이블은 방문한 손님 수를 나타내는 `number of guests` 을 가진다.
- 주문 테이블은 테이블이 비워져있는지를 나타내는 `empty` 을 가진다.

#### 기능/조건

- 주문 테이블을 등록할 수 있다.
    - 주문 테이블의 `name` 은 비워 둘 수 없다.
    - 주문 테이블의 `name` 은 `profanity` 가 포함될 수 없다.
        - `PurgoMalum Client` 가 비속어를 필터링 한다.
- 빈 테이블을 해지할 수 있다.
- 빈 테이블로 설정할 수 있다.
    - 주문 테이블의 `order status` 가 `COMPLETED` 가 아니라면 설정할 수 없다.
- 방문한 손님 수를 변경할 수 있다.
    - `number of guests` 는 0 이상이어야 한다.
    - `empty` 테이블은 `number of guests` 를 변경할 수 없으며, 항상 값이 0이다.
- 주문 테이블의 목록을 조회할 수 있다.

### 주문(Order) Context

#### 속성

- 주문은 어떤 주문인지 타입을 나타내는 `order type` 을 가진다.
    - 배달 주문은 `DELIVERY` 타입이다.
    - 포장 주문은 `TAKEOUT` 타입이다.
    - 매장 주문은 `EAT_IN` 타입이다.
- 주문은 현재 상태를 나타내는 `order status` 를 가진다.
    - 주문이 접수 중이라면 `WAITING` 상태이다.
    - 주문이 접수 되었다면 `ACCEPTED` 상태이다.
    - 주문이 서빙되었다면 `SERVED` 상태이다.
    - 주문이 배달 중이라면 `DELIVERING` 상태이다.
    - 주문이 배달되었다면 `DELIVERED` 상태이다.
    - 주문이 완료되었다면 `COMPLETED` 상태이다.
- 주문은 주문 일시를 나타내는 `order date time` 을 가진다.
- 배달 주문은 배달할 주소를 나타내는 `delivery address` 를 가질 수 있다.
- 주문은 주문 항목들(`order line items`) 를 가진다.
    - `order line item` 은 주문한 `menu` 를 가진다.
    - `order line item` 은 주문한 메뉴를 식별하기 위한 `menu id` 를 가진다.
    - `order line item` 은 주문 항목 수량(`quantity`) 를 가진다.
    - `order line item` 은 주문의 `price` 를 가진다.

#### 기능/조건

- 주문을 등록할 수 있다.
    - 1개 이상의 등록된 `menu` 로 주문을 등록할 수 있다.
    - `menu` 가 없는 주문은 등록할 수 없다.
    - `order type` 이 올바르지 않으면 등록할 수 없다.
    - `order status` 가 올바르지 않으면 등록할 수 없다.
    - `EAT_IN` 타입의 주문은 `order line item` 의 `quantity` 가 0 미만일 수 있다.
    - `EAT_IN` 을 제외한 타입의 주문은 `order line item` 의 `quantity` 가 0 이상이어야 한다.
    - `delivery address` 가 비워져 있다면, `DELIVERY` 주문을 등록할 수 없다.
    - `empty` 테이블에는 `EAT_IN` 타입의 주문을 등록할 수 없다.
    - 숨겨진 메뉴는 주문할 수 없다.
    - 주문한 메뉴의 `price` 와 `order line iteml` 의 `price` 는 일치해야한다.
- 주문을 접수할 수 있다.
    - `WAITING` 상태의 주문만 접수 할 수 있다.
    - `DELIVERY` 타입의 주문을 접수하면, 배달 대행사(`kitchen riders`) 를 호출한다.
- 주문을 서빙할 수 있다.
    - `ACCEPTED` 상태의 주문만 서빙할 수 있다.
- 주문의 배달을 시작할 수 있다.
    - `DELIVERY` 타입이고, `SERVED` 상태의 주문만 배달할 수 있다.
    - 배달 대행사(`kitchen riders`)가 주문의 배달을 수행한다.
- 주문의 배달을 완료할 수 있다.
    - `DELIVERING` 상태의 주문만 배달 완료할 수 있다.
- 주문을 완료할 수 있다.
    - `DELIVERY` 타입의 주문일 경우, `DELIVERED` 상태의 주문만 완료할 수 있다.
    - `TAKEOUT` 혹은 `EAT_IN` 타입 주문일 경우, `SERVED` 상태의 주문만 완료할 수 있다.
    - `order table` 의 모든 매장 주문이 완료되면 `empty` 테이블로 설정한다.
    - `COMPLETED` 상태가 아닌 매장 주문이 있는 주문 테이블은 `empty` 테이블로 설정할 수 없다.
- 주문 목록을 조회할 수 있다.

## 패키지 설명

* domain : domain layer 
    - aggreagte, repository, domain service 와 같이 도메인에서 처리하는 클래스들을이 위치하는 패키지
* application : application laeyr 
    - 응용 서비스(application service)를 모아두는 패키지 
* ui : presentation layer 
    - controller와 같이 외부 client의 요청을 받는 클래스를 모아두는 패키지 
* infra : infrastructure layer 
    - 이메일, 메시지 알림등과 같은 외부 서비스와 관련된 클래스를 모아두는 패키지
* dto
    - request, response, layer 간 데이터 이동을 위한 클래스를 정의하는 패키지
